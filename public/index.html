<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <script type="text/javascript" src="d3.js"></script>
  <style type="text/css">
  </style>
  <title>Redneck Inc.</title>
  <style>
    #heading1{
      text-align: center;
      text-shadow: 0 0 2px darkgrey;
      color: silver;
      font-family:verdana,sans-serif;
      font-size: 350%;
    }
    body{
      background-color: #000322;
    }
    #text{
      color: white;
    }
  </style>
</head>

<body>
  <h1 id="heading1">Rednecks Inc.</h1>
  <script type="text/javascript">
    
  // Denne query kører op imod API'en som findes i 'main.js'.
  // Denne HTML skal derfor åbnes igennem serveren for at virke.
  d3.json("/api/RedneckInc", {
    method: "POST", 
  }).then(function(response) {
    const data = response.data; // Hent data ud af response
    console.log("response", response);

    const w = 1200;
    const h = 620;

    // Lav SVG element
    const svg = d3.select("body")
      .append("svg")
      .attr("width", w)
      .attr("height", h);

    // Lav din egen visualsering med data her!
    
    // Hent GeoJSON
    d3.json("./continents.json").then(function (json) {
      console.log(json);

    // Lav en mercator projection, fit ind i w og h
    const projection = d3.geoMercator().fitSize([w, h], json).scale([150]);

    // Lav en path ud fra projektion
    const path = d3.geoPath(projection);

    // Mus over effekt function
    let mouseOver = function(d){
            d3.selectAll(".continent")
            .transition()
            .duration(50)
            .style("opacity", 0.5)
            d3.select(this)
            .transition()
            .duration(50)
            .style("opacity", 1.5)
            .style("stroke", "yellow")
    };

    // Mus flyttes effekt function
    let mouseLeave = function(d){
            d3.selectAll(".continent")
            .transition()
            .duration(50)
            .style("opacity", 1)
            d3.select(this)
            .transition()
            .duration(50)
            .style("stroke", "transparent")
    };

    // Tegn path med SVG. Path data indsættes som 'd'-attribut
  
    // Tegner kontinenter
    svg.selectAll("path")
      .data(json.features)
      .enter()
      .append("path")
      .attr("d", path)
      .attr("stroke", function(d){
        return "black";
      })
      .attr("fill", function(d){
        return "silver";
      })
      .attr("class", function(g){return "continent"})
      .on("mouseover", mouseOver )
      .on("mouseleave", mouseLeave )
  });
});
  </script>
</body>
</html>